# نظام الإشعارات والتأكيدات الشامل - يناير 2025

## نظرة عامة
تم إضافة نظام إشعارات موحد (Toast Notification System) في جميع أجزاء النظام لتوفير رسائل نجاح/خطأ واضحة ومفيدة للمستخدمين.

## المكونات الجديدة

### 1. Toast Component
**الملف**: `apps/web-portal/src/components/ui/Toast.tsx`
- مكون UI لعرض الإشعارات
- يدعم 4 أنواع: success, error, warning, info
- إغلاق تلقائي بعد مدة محددة
- تصميم متجاوب مع الألوان المناسبة

### 2. Toast Context
**الملف**: `apps/web-portal/src/contexts/ToastContext.tsx`
- Context لإدارة الإشعارات في التطبيق
- دوال مساعدة: `showSuccess`, `showError`, `showWarning`, `showInfo`
- إدارة تلقائية لحذف الإشعارات بعد انتهاء المدة

### 3. Error Messages Helper
**الملف**: `apps/web-portal/src/lib/errorMessages.ts`
- ترجمة مركزية لجميع رسائل الخطأ
- دالة `getErrorMessage` لتحويل الأخطاء إلى رسائل واضحة بالعربية
- دالة `getDetailedErrorMessage` للحصول على عنوان ورسالة مفصلة

## الصفحات المحدثة

### 1. People (الأشخاص)
- ✅ إضافة/تحديث/حذف شخص
- ✅ تفعيل/تعطيل شخص
- ✅ معالجة أخطاء Face Encoding

### 2. Vehicles (المركبات)
- ✅ إضافة/تحديث/حذف مركبة
- ✅ تفعيل/تعطيل مركبة

### 3. Cameras (الكاميرات)
- ✅ إضافة/تحديث/حذف كاميرا
- ✅ رسائل نجاح/خطأ واضحة

### 4. Settings (الإعدادات)
- ✅ إضافة/تحديث/حذف Edge Server
- ✅ اختبار اتصال السيرفر
- ✅ رسائل نجاح/خطأ واضحة

### 5. Automation (الأتمتة)
- ✅ إضافة/تحديث/حذف قاعدة أتمتة
- ✅ تفعيل/تعطيل قاعدة
- ✅ رسائل نجاح/خطأ واضحة

### 6. Login (تسجيل الدخول)
- ✅ رسائل خطأ واضحة عند فشل تسجيل الدخول
- ✅ رسالة نجاح عند تسجيل الدخول بنجاح
- ✅ معالجة أخطاء المصادقة

### 7. Organization Settings (إعدادات المؤسسة)
- ✅ رفع/حذف شعار المؤسسة
- ✅ حفظ إعدادات المؤسسة
- ✅ رسائل نجاح/خطأ واضحة

## رسائل الخطأ المدعومة

### Authentication (المصادقة)
- "البريد الإلكتروني أو كلمة المرور غير صحيحة"
- "الحساب معطل. يرجى التواصل مع المدير"
- "يرجى تسجيل الدخول أولاً"

### Validation (التحقق)
- "البيانات المدخلة غير صحيحة"
- "هذا الحقل مطلوب"
- "البريد الإلكتروني غير صحيح"
- "كلمة المرور قصيرة جداً (الحد الأدنى 6 أحرف)"

### Resources (الموارد)
- "المورد المطلوب غير موجود"
- "هذا المورد موجود مسبقاً"

### Network (الشبكة)
- "خطأ في الاتصال بالشبكة. يرجى المحاولة مرة أخرى"
- "انتهت مهلة الطلب. يرجى المحاولة مرة أخرى"
- "خطأ في الخادم. يرجى المحاولة لاحقاً"

### Permissions (الصلاحيات)
- "ليس لديك صلاحية كافية"
- "تم رفض الوصول"

## كيفية الاستخدام

### في أي صفحة:
```typescript
import { useToast } from '../contexts/ToastContext';
import { getDetailedErrorMessage } from '../lib/errorMessages';

function MyComponent() {
  const { showSuccess, showError, showWarning, showInfo } = useToast();

  const handleAction = async () => {
    try {
      // ... عمل ما
      showSuccess('تم الحفظ بنجاح', 'تم حفظ البيانات بنجاح');
    } catch (error) {
      const { title, message } = getDetailedErrorMessage(error, 'حفظ البيانات', 'حدث خطأ');
      showError(title, message);
    }
  };
}
```

## المزايا

1. **رسائل واضحة**: جميع الرسائل بالعربية وواضحة
2. **أسباب الأخطاء**: كل خطأ يوضح السبب (مثل: كلمة مرور غير صحيحة)
3. **تصميم موحد**: جميع الإشعارات بنفس التصميم
4. **إغلاق تلقائي**: الإشعارات تُغلق تلقائياً بعد مدة محددة
5. **سهولة الاستخدام**: دالة واحدة لكل نوع من الإشعارات

## الخطوات التالية

1. ✅ إضافة Toast Provider في App.tsx
2. ✅ تحديث الصفحات الرئيسية
3. ⏳ تحديث باقي الصفحات (Admin pages, Alerts, Analytics, etc.)
4. ⏳ إضافة المزيد من رسائل الخطأ المخصصة

## ملاحظات

- جميع الإشعارات تظهر في أعلى الصفحة على اليسار
- مدة عرض الإشعارات:
  - Success: 4 ثواني
  - Error: 6 ثواني
  - Warning: 5 ثواني
  - Info: 4 ثواني
- يمكن إغلاق الإشعار يدوياً بالضغط على X

