# ๐ ุฏููู ุงูุฑุจุท ุงูุณุญุงุจู - STC AI-VAP (Laravel + Edge)

ูุฐุง ุงูุฏููู ููุถูุญ ููููุฉ ุฑุจุท ุฎุงุฏู ุงููEdge ุงููุญูู ุจู Laravel SaaS ุนูู ุงููVPS ูุน ุขููุฉ ุงููุฒุงููุฉุ ุงูุชุฑุฎูุต ุจูุชุฑุฉ ุณูุงุญ 14 ููููุงุ ูุงูุฃูุงูุฑ ุนู ุจูุนุฏ.

## โ๏ธ ุงูููููุงุช ุงูุฑุฆูุณูุฉ
- **Edge Server (`apps/edge-server`)**: ูุดุบูู ููุงุฐุฌ ุงููAIุ ูุญูุธ ุงููุณุงุฆุท ูุญูููุงุ ููุฑุณู ููุชุงุฏุงุชุง ููุท ุฅูู ุงูุณุญุงุจุฉ.
- **Cloud Laravel (`apps/cloud-laravel`)**: ูุฏูุฑ ุงูุชุฑุงุฎูุตุ ุงููุณุชุฎุฏูููุ ุงูููุธูุงุชุ ุงูููุฒุนููุ ุงุณุชูุจุงู ุงูููุชุงุฏุงุชุงุ ูุฅุฑุณุงู ุฃูุงูุฑ ุงูุชุญูู. ุงููุงุฌูุฉ ูุงููAPI ูู ุญุฒูุฉ ูุงุญุฏุฉ.
- **Web/Mobile**: ุชุณุชููู Laravel API (Sanctum) ูุนุฑุถ ุงูุญุงูุฉ ูุงูุชูุจููุงุช ูุงูุญุถูุฑ.

## ๐ ูุณุงุฑ ุงููุฒุงููุฉ ูุงูุชุฑุฎูุต
1. **ุงูุชููุฆุฉ ุงูุฃููู**: ูู `/setup` ุนูู ุงููEdge ูุชู ุฅุฏุฎุงู `CLOUD_API_URL` ู`LICENSE_KEY` ูุงูุชุญูู ุนุจุฑ `POST /api/license/validate` (Laravel).
2. **ุงูุชุฎุฒูู ุงููุญูู**: ูุชู ุญูุธ ูุชูุฌุฉ ุงูุชุฑุฎูุต (ุชุงุฑูุฎ ุงูุงูุชูุงุก + ูุชุฑุฉ ุงูุณูุงุญ 14 ููููุง) ููุณูุงุญ ุจุงูุนูู ุฃูููุงูู.
3. **ุงููุจุถุงุช (Heartbeat)**: ูู `HEARTBEAT_INTERVAL` ุซุงููุฉ ูุฑุณู ุงููEdge ุทูุจ `POST /api/edges/heartbeat` ูุชุญุฏูุซ ุงูุญุงูุฉ ูุงูุฅุตุฏุงุฑ.
4. **ุตู ุงููุฒุงููุฉ**: ุงูุฃุญุฏุงุซ/ุงูุชูุจููุงุช ุชูุณุฌู ูุญูููุง ูุน `synced=False` ุซู ุชุฑุณู ุฅูู `POST /api/edges/events`ุ ูุนูุฏ ุงููุฌุงุญ ูุชู ุชุนููููุง `synced=True`.
5. **ุงูุฃูุงูุฑ ุนู ุจูุนุฏ**: ูุณุญุจ ุงููEdge ุงูุฃูุงูุฑ ุนุจุฑ `GET /api/edges/{hardware_id}/commands` ููุคูุฏ ุงูุชูููุฐ ุจู`POST /api/edges/commands/{id}/ack`.

## ๐งช ุฎุทูุงุช ุฏูุฌ ุณุฑูุนุฉ
1. **ุชุดุบูู Laravel Cloud**
   ```bash
   cd apps/cloud-laravel
   cp .env.example .env  # ุนุฏูู ุฅุนุฏุงุฏุงุช DB ู MAIL/FCM
   composer install --no-dev --optimize-autoloader
   npm install && npm run build
   php artisan key:generate
   psql -U <user> -d <db> -f database/schema.sql  # ุจูุงูุงุช ุฌุงูุฒุฉ
   php artisan serve --host 0.0.0.0 --port 8000
   ```
   ุชุญูู ูู `http://localhost:8000`.

2. **ุชุดุบูู ุงููEdge**
   ```bash
   cd apps/edge-server
   python -m venv .venv && source .venv/bin/activate
   pip install -r requirements.txt
   cp .env.example .env  # ุฃุฏุฎู CLOUD_API_URL + LICENSE_KEY
   uvicorn main:app --host 0.0.0.0 --port 8080
   ```
   ุงูุชุญ `http://localhost:8080/setup` ูุฃุชูู ุงูุฑุจุท.

3. **ุชุฌุฑุจุฉ ุชุฏูู ูุงูู**
   - ุฃุฑุณู ุญุฏุซูุง ุชุฌุฑูุจููุง ูู ุงููEdge ูุชุฃูุฏ ูู ุธููุฑู ูู ุฌุฏูู ุงูุฃุญุฏุงุซ ูู Laravel.
   - ุฃุถู ุฃูุฑ ุชุญูู ุนุจุฑ ููุญุฉ Laravel (ุฃู API `POST /api/edges/commands`) ุซู ุฑุงูุจ ุณุญุจู ูุชุฃููุฏู ูู ุงููEdge.

## ๐งฉ ููุงุท ุงููAPI ุงูุฃุณุงุณูุฉ (Laravel)
- `POST /api/auth/login` โ ุชุณุฌูู ุงูุฏุฎูู ูุงูุญุตูู ุนูู ุชููู.
- `POST /api/license/validate` โ ุชุญูู ุงูุชุฑุฎูุต ูุญุณุงุจ ูุชุฑุฉ ุงูุณูุงุญ.
- `POST /api/edges/register` โ ุชุณุฌูู ุงููEdge ูุฑุจุทู ุจุงูุชุฑุฎูุต/ุงูููุธูุฉ.
- `POST /api/edges/heartbeat` โ ุชุญุฏูุซ ุงูุญุงูุฉ.
- `GET /api/edges/{hardware_id}/commands` โ ุงูุฃูุงูุฑ ุงููุนูููุฉ.
- `POST /api/edges/commands/{command_id}/ack` โ ุชุฃููุฏ ุงูุชูููุฐ.
- `POST /api/edges/events` โ ุงุณุชูุงู ุงูููุชุงุฏุงุชุง (ุชูุจููุงุช/ุญุถูุฑ/ุชุญูููุงุช).

### Edge endpoints (ูุญููุฉ)
- `GET /health` โ ูุญุต ุงูุญุงูุฉ.
- `GET /setup` โ ูุนุงูุฌ ุงูุชููุฆุฉ ุงูุฃููู.
- `GET /api/v1/status` โ ุญุงูุฉ ุงููุธุงู ุงูุชูุตูููุฉ.
- `GET /api/v1/cameras` โ ุงููุงููุฑุงุช ุงููุณุฌููุฉ ูุญูููุง.
- `GET /api/v1/modules` โ ุงูููุฏูููุงุช ูุชูุนูููุง.

## ๐ ุงูุฃูุงู
- ูุนูู HTTPS ุนูู ุงููVPS (Nginx) ูุงุณุชุฎุฏู ููุงุชูุญ ุจูุฆุฉ ูุญููุฉ ูู Sanctum ู FCM.
- ุงุญุชูุธ ุจู `CLOUD_API_URL` ู`LICENSE_KEY` ูู ูููุงุช `.env` ุบูุฑ ูุชุชุจุนุฉ.

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก
- ุชุฃูุฏ ูู ุตุญุฉ ุนููุงู Laravel ูุฃู ุงููููุฐ 8000/443 ููุชูุญ ูู ูููุน ุงููEdge.
- ุชุญูู ูู ุณุฌูุงุช ุงููEdge (`logs/edge_server.log`) ููู ุณุฌูุงุช Laravel (`storage/logs/laravel.log`).
- ุฅุฐุง ุงูุชูุช ุตูุงุญูุฉ ุงูุชุฑุฎูุต + ุชุนุฏุช ูุชุฑุฉ ุงูุณูุงุญ 14 ููููุงุ ูุชู ุชุนุทูู ุงููAI ุญุชู ูุชู ุงูุชูุนูู ูู ุฌุฏูุฏ.

## ๐ ูุฑุงูุจุฉ ูุชุดุบูู
- ุงุณุชุฎุฏู ููุญุฉ Laravel ูุงููFlutter App ูุงุณุชููุงู ุงููAPI ูุนุฑุถ ุงูุชูุจููุงุช ูุงูุญุถูุฑ ูุญุงูุฉ ุงููEdge.
- ุงุณุชุฎุฏู endpoints ุงูุฃูุงูุฑ ููุชุญูู ูู ุงูุชูุงููุงุช (GPIO/Modbus/Arduino) ุนุจุฑ ูุณูุท ุงูุชูููุฐ ูู ุงููEdge.
